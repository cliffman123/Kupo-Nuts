{"version":3,"file":"static/js/415.b5b1b1be.chunk.js","mappings":"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","sources":["config.js","components/VideoList.js"],"sourcesContent":["// Dynamic configuration based on environment\n\n// Detect if we're running in development mode\nconst isDevelopment = process.env.NODE_ENV === 'development' || \n                      window.location.hostname === 'localhost' || \n                      window.location.hostname === '127.0.0.1';\n\n// Set API URL based on environment\nconst config = {\n  API_URL: process.env.NODE_ENV === 'production' \n    ? 'https://kupo-nuts.onrender.com'\n    : 'http://localhost:5000'\n};\n\nconsole.log('Running in', isDevelopment ? 'DEVELOPMENT' : 'PRODUCTION', 'mode');\nconsole.log('Using API URL:', config.API_URL);\n\nexport default config;\n","import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport Masonry from 'react-masonry-css';\nimport './VideoList.css';\nimport defaultLinks from './default-links.json';\nimport config from '../config'; // Import the config file\nimport io from 'socket.io-client';\n\nconst API_URL = config.API_URL;\nconst LOCAL_STORAGE_KEY = 'kupoNuts_mediaLinks'; // Add this constant for localStorage key\n\n// Add helper functions for localStorage\nconst saveToLocalStorage = (mediaLinks, storageKey = LOCAL_STORAGE_KEY) => {\n    try {\n        localStorage.setItem(storageKey, JSON.stringify(mediaLinks));\n    } catch (error) {\n        console.error('Error saving to localStorage:', error);\n    }\n};\n\nconst getFromLocalStorage = (storageKey = LOCAL_STORAGE_KEY) => {\n    try {\n        const data = localStorage.getItem(storageKey);\n        return data ? JSON.parse(data) : [];\n    } catch (error) {\n        console.error('Error reading from localStorage:', error);\n        return [];\n    }\n};\n\nconst addToLocalStorage = (mediaItem, storageKey = LOCAL_STORAGE_KEY) => {\n    try {\n        const currentLinks = getFromLocalStorage(storageKey);\n        // Check if item already exists to prevent duplicates\n        const exists = currentLinks.some(item => item.postLink === mediaItem.postLink);\n        if (!exists) {\n            currentLinks.push(mediaItem);\n            saveToLocalStorage(currentLinks, storageKey);\n        }\n        return currentLinks;\n    } catch (error) {\n        console.error('Error adding to localStorage:', error);\n        return [];\n    }\n};\n\nconst VideoList = () => {\n    const [mediaUrls, setMediaUrls] = useState([]);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [fullscreenMedia, setFullscreenMedia] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const [autoScroll, setAutoScroll] = useState(false);\n    const [filter, setFilter] = useState('random'); // Default to random\n    const [showSettings, setShowSettings] = useState(false);\n    const [notifications, setNotifications] = useState([]);\n    const [isClickable, setIsClickable] = useState(true);\n    const [loadedMedia, setLoadedMedia] = useState({});\n    const [randomSeed, setRandomSeed] = useState(Date.now());\n    const [tagFilter, setTagFilter] = useState(null);\n    const [contentFilter, setContentFilter] = useState('sfw'); // Default to 'sfw'\n    const [globalVolume, setGlobalVolume] = useState(0.1); // Add global volume state with default 10%\n    // eslint-disable-next-line no-unused-vars\n    const [socket, setSocket] = useState(null); // Add socket state here\n    const [searchQuery, setSearchQuery] = useState(''); // New unified search query\n    const guestId = useRef(localStorage.getItem('kupoguestid') || `guest-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n    const [showDefaultLinks, setShowDefaultLinks] = useState(false); // Add state for showing default links\n    const [activeCollection, setActiveCollection] = useState('main'); // Add state for active collection\n    const [collections] = useState([\n        { id: 'main', name: 'Main', storageKey: LOCAL_STORAGE_KEY },\n        { id: 'sub', name: 'Sub', storageKey: 'kupoNuts_sub' },\n        { id: 'extra', name: 'Extra', storageKey: 'kupoNuts_extra' }\n    ]); // Add predefined collections\n    const [showMobileMenu, setShowMobileMenu] = useState(false); // Add state for mobile menu\n    const [isMobile, setIsMobile] = useState(false); // Add state to track mobile viewport\n    const prevScrollY = useRef(0); // Add ref to track previous scroll position\n    const scrollAnimation = useRef(null); // Add ref for scroll animation\n    const mediaRefs = useRef([]);\n    const mediaSet = useRef(new Set());\n    const observer = useRef();\n    const scrapeNotificationId = useRef(null);\n    const similarNotificationId = useRef(null); // Keep separate IDs for different operations\n    const tagSearchNotificationId = useRef(null);\n    const [showConfirmClear, setShowConfirmClear] = useState(false);\n    const [tagBlacklist, setTagBlacklist] = useState('');\n    const [scrollSpeed, setScrollSpeed] = useState(3); // Default scroll speed\n    // eslint-disable-next-line no-unused-vars\n    const [tagSearchQuery, setTagSearchQuery] = useState('');\n    // Konami Code state for hidden NSFW toggle\n    // eslint-disable-next-line no-unused-vars\n    const [konamiSequence, setKonamiSequence] = useState([]);\n    const konamiCode = useMemo(() => ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'], []);\n\n    const initialMediaPerPage = 8;\n    const mediaPerPage = 16;\n\n    const shuffleArray = useCallback((array) => {\n        const newArray = [...array];\n        newArray.reverse();\n        const rand = seedrandom(randomSeed.toString());\n        for (let i = newArray.length - 1; i > 0; i--) {\n            const j = Math.floor(rand() * (i + 1));\n            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];\n        }\n        newArray.reverse();\n        return newArray;\n    }, [randomSeed]);\n\n    const fetchConfig = {\n        credentials: 'include',\n    };\n\n    // Add a new helper function to filter media by tag\n    const filterMediaByTag = useCallback((mediaLinks, searchTerm) => {\n        if (!searchTerm) return mediaLinks;\n        \n        const lowercaseSearchTerm = searchTerm.toLowerCase();\n        return mediaLinks.filter(item => {\n            const tags = item[2];\n            \n            // Handle array format tags (legacy format)\n            if (Array.isArray(tags)) {\n                return tags.some(tag => tag.toLowerCase().includes(lowercaseSearchTerm));\n            }\n            \n            // Handle object format tags (current format)\n            return Object.values(tags).some(categoryTags => \n                Array.isArray(categoryTags) && categoryTags.some(tag => \n                    tag.toLowerCase().includes(lowercaseSearchTerm)\n                )\n            );\n        });\n    }, []);\n\n    const applyTagBlacklist = useCallback((media) => {\n        if (!tagBlacklist) return media;\n\n        const blacklist = tagBlacklist.split(',').map(tag => tag.trim().toLowerCase());\n\n        return media.filter(item => {\n            const tags = item[2];\n\n            if (!tags) return true;\n\n            const allTags = [];\n\n            if (Array.isArray(tags)) {\n                tags.forEach(tag => allTags.push(tag.toLowerCase()));\n            } else {\n                Object.values(tags).forEach(categoryTags => {\n                    if (Array.isArray(categoryTags)) {\n                        categoryTags.forEach(tag => allTags.push(tag.toLowerCase()));\n                    }\n                });\n            }\n\n            return !blacklist.some(blacklistedTag =>\n                allTags.some(tag => tag.includes(blacklistedTag))\n            );\n        });\n    }, [tagBlacklist]);\n\n    const fetchMedia = useCallback(async (page, limit) => {\n        setLoading(true);\n        try {\n            let mediaLinks = [];\n            \n            // Always use localStorage based on active collection\n            const currentCollection = collections.find(c => c.id === activeCollection);\n            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n            const localStorageLinks = getFromLocalStorage(storageKey);\n            \n            if (localStorageLinks && localStorageLinks.length > 0) {\n                // Format localStorage data to match expected array format\n                mediaLinks = localStorageLinks.map(item => [\n                    item.postLink || '',\n                    item.videoLinks || [],\n                    item.tags || {}\n                ]);\n            }\n            \n            // Add default links when localStorage is empty or showDefaultLinks is enabled\n            if ((mediaLinks.length === 0 || showDefaultLinks) && defaultLinks?.length > 0) {\n                const defaultMediaLinks = defaultLinks.map(item => [item.postLink || '', item.videoLinks, item.tags || {}]);\n                mediaLinks = mediaLinks.length > 0 ? \n                    (showDefaultLinks ? [...mediaLinks, ...defaultMediaLinks] : mediaLinks) : \n                    defaultMediaLinks;\n            }\n\n            // Step 2: Apply tag filtering if needed\n            if (tagFilter) {\n                mediaLinks = filterMediaByTag(mediaLinks, tagFilter);\n            }\n\n            // Apply tag blacklist\n            mediaLinks = applyTagBlacklist(mediaLinks);\n\n            // Step 3: Apply sorting based on filter\n            const totalAvailableItems = mediaLinks.length;\n            const startIndex = (page - 1) * limit;\n\n            let sortedMediaLinks = [];\n\n            switch (filter.toLowerCase()) {\n                case 'newest': \n                    // For non-logged in users, keep local storage items first (in reverse order)\n                    // followed by default items (also in reverse order)\n                    sortedMediaLinks = [...mediaLinks].reverse();\n                    break;\n                case 'random':\n                    sortedMediaLinks = shuffleArray([...mediaLinks]);\n                    break;\n                case 'oldest':\n                    sortedMediaLinks = [...mediaLinks];\n                    break;\n                default:\n                    sortedMediaLinks = page % 2 === 0 \n                        ? [...mediaLinks].reverse() \n                        : shuffleArray([...mediaLinks]);\n                    break;\n            }\n\n            // Step 4: Paginate and update state\n            const endIndex = Math.min(startIndex + limit, totalAvailableItems);\n           \n            const pageMediaUrls = sortedMediaLinks.slice(startIndex, endIndex);\n\n            if (startIndex >= totalAvailableItems) {\n                console.log('Reached the end of media items, refreshing...');\n                return;\n            }\n\n            // Step 5: Update state with unique media items\n            if (page === 1) {\n                mediaSet.current.clear();\n                setMediaUrls(pageMediaUrls);\n            } else {\n                const uniqueMediaUrls = pageMediaUrls.filter(media => !mediaSet.current.has(media[1][0]));\n                uniqueMediaUrls.forEach(media => mediaSet.current.add(media[1][0]));\n                setMediaUrls(prevMediaUrls => [...prevMediaUrls, ...uniqueMediaUrls]);\n            }\n            \n        } catch (error) {\n            console.error('Error fetching media:', error);\n            \n            // Fallback to localStorage and defaults\n            const currentCollection = collections.find(c => c.id === activeCollection);\n            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n            const localStorageLinks = getFromLocalStorage(storageKey);\n            let mediaLinks = [];\n            \n            if (localStorageLinks && localStorageLinks.length > 0) {\n                mediaLinks = localStorageLinks.map(item => [\n                    item.postLink || '',\n                    item.videoLinks || [],\n                    item.tags || {},\n                    { isUserContent: true } // Mark as user content\n                ]);\n            }\n            \n            // Always show defaults in error cases if localStorage is empty\n            if (mediaLinks.length === 0 && defaultLinks?.length > 0) {\n                const defaultMediaLinks = defaultLinks.map(item => [\n                    item.postLink || '', \n                    item.videoLinks, \n                    item.tags || {},\n                    { isDefault: true } // Mark as default content\n                ]);\n                mediaLinks = defaultMediaLinks;\n            } else if (showDefaultLinks && defaultLinks?.length > 0) {\n                // Add default links when showDefaultLinks is enabled\n                const defaultMediaLinks = defaultLinks.map(item => [\n                    item.postLink || '', \n                    item.videoLinks, \n                    item.tags || {},\n                    { isDefault: true } // Mark as default content\n                ]);\n                mediaLinks = [...mediaLinks, ...defaultMediaLinks];\n            }\n            \n            if (mediaLinks.length > 0) {\n                // Apply filtering, sorting, and pagination similar to the main function\n                if (tagFilter) {\n                    mediaLinks = filterMediaByTag(mediaLinks, tagFilter);\n                }\n\n                mediaLinks = applyTagBlacklist(mediaLinks);\n                \n                let sortedMediaLinks = [];\n\n                const userItems = mediaLinks.filter(item => item[3]?.isUserContent).reverse();\n                const defaultItems = mediaLinks.filter(item => item[3]?.isDefault).reverse();\n\n                switch (filter.toLowerCase()) {\n                    case 'newest':\n                        // Keep local storage items first (in reverse order)\n                        // followed by default items (also in reverse order)\n                        sortedMediaLinks = [...userItems, ...defaultItems];\n                        break;\n                    case 'random':\n                        sortedMediaLinks = shuffleArray([...mediaLinks]);\n                        break;\n                    case 'oldest':\n                        sortedMediaLinks = [...mediaLinks];\n                        break;\n                    default:\n                        sortedMediaLinks = shuffleArray([...mediaLinks]);\n                        break;\n                }\n                \n                const totalAvailableItems = sortedMediaLinks.length;\n                const startIndex = (page - 1) * limit;\n                const endIndex = Math.min(startIndex + limit, totalAvailableItems);\n                const pageMediaUrls = sortedMediaLinks.slice(startIndex, endIndex);\n                \n                if (startIndex >= totalAvailableItems) {\n                    console.log('Reached the end of media items, refreshing...');\n                    return;\n                }\n                \n                if (page === 1) {\n                    mediaSet.current.clear();\n                    setMediaUrls(pageMediaUrls);\n                } else {\n                    const uniqueMediaUrls = pageMediaUrls.filter(media => !mediaSet.current.has(media[1][0]));\n                    uniqueMediaUrls.forEach(media => mediaSet.current.add(media[1][0]));\n                    setMediaUrls(prevMediaUrls => [...prevMediaUrls, ...uniqueMediaUrls]);\n                }\n            }\n        } finally {\n            setLoading(false);\n        }\n    }, [filter, shuffleArray, tagFilter, showDefaultLinks, filterMediaByTag, applyTagBlacklist, activeCollection, collections]);\n\n    const setCookies = () => {\n        const cookies = JSON.parse(localStorage.getItem('cookies'));\n        if (cookies) {\n            cookies.forEach(cookie => {\n                document.cookie = `${cookie.name}=${cookie.value}; domain=${cookie.domain}; path=${cookie.path}`;\n            });\n        }\n    };\n\n    const showNotification = (message, type = 'info') => {\n        // Create a more unique ID using both timestamp and a random string\n        const id = `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`; \n        const newNotification = { id, message, type };\n        \n        setNotifications(prev => [...prev, newNotification]);\n        \n        // Remove this specific notification after 3 seconds\n        setTimeout(() => {\n            setNotifications(prev => prev.filter(notification => notification.id !== id));\n        }, 3000);\n    };\n\n    const removeNotification = (id) => {\n        setNotifications(prev => prev.filter(notification => notification.id !== id));\n    };\n\n    const showProgressNotification = (id, message, progress, isComplete) => {\n        setNotifications(prev => {\n            const existingNotificationIndex = prev.findIndex(n => n.id === id);\n\n            if (existingNotificationIndex !== -1) {\n                const updatedNotifications = [...prev];\n                updatedNotifications[existingNotificationIndex] = {\n                    ...updatedNotifications[existingNotificationIndex],\n                    message,\n                    progress,\n                    isComplete\n                };\n                return updatedNotifications;\n            } else {\n                return [...prev, { id, message, type: 'progress', progress, isComplete }];\n            }\n        });\n    };\n\n    const handleScrape = async (url = null) => {\n        const urlToScrape = url;\n\n        try {\n            const headers = {\n                'Content-Type': 'application/json',\n                'x-guest-id': guestId.current\n            };\n\n            console.log('Scraping URL:', urlToScrape);\n            console.log('Guest user');\n            \n            const response = await fetch(`${API_URL}/api/scrape`, {\n                method: 'POST',\n                headers: headers,\n                ...fetchConfig,\n                body: JSON.stringify({ url: urlToScrape }),\n            });\n            \n            if (!response.ok) {\n                throw new Error('Network response was not ok');\n            }\n            \n            // Results will come through WebSocket and be saved to browser\n            showNotification('Scraping started - results will be saved to your browser', 'info');\n            \n        } catch (error) {\n            console.error('Failed to scrape:', error);\n            showNotification(error.message || 'Failed to scrape. Please try again.', 'error');\n            removeNotification(scrapeNotificationId.current);\n        }\n    };\n\n    const handleRemove = async (postLink) => {\n        try {\n            // Remove from the active collection's localStorage\n            const currentCollection = collections.find(c => c.id === activeCollection);\n            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n            const localStorageLinks = getFromLocalStorage(storageKey);\n            saveToLocalStorage(localStorageLinks.filter(item => item.postLink !== postLink), storageKey);\n\n            // Update the local state to remove the entire post\n            setMediaUrls(prevMediaUrls => \n                prevMediaUrls.filter(media => media[0] !== postLink)\n            );\n\n            showNotification('Media removed successfully', 'success');\n        } catch (error) {\n            console.error('Failed to remove media:', error);\n            showNotification('Failed to remove media', 'error');\n        }\n    };\n\n    const scrapeSavedLinks = async () => {\n        try {\n            const response = await fetch(`${API_URL}/api/scrape-saved-links`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                ...fetchConfig\n            });\n            if (!response.ok) throw new Error('Network response was not ok');\n        } catch (error) {\n            alert('Failed to scrape media. Please try again later.');\n            showNotification('Failed to scrape media. Please try again later.', 'error');\n        }\n    };\n\n    // Updated handleSimilar function\n    const handleSimilar = async (postLink) => {\n\n        const headers = {\n            'Content-Type': 'application/json',\n            'x-guest-id': guestId.current\n        };\n\n        try {\n            const response = await fetch(`${API_URL}/api/similar`, {\n                method: 'POST',\n                headers: headers,\n                ...fetchConfig,\n                body: JSON.stringify({ url: postLink }),\n            });\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({}));\n                throw new Error(errorData.message || 'Failed to find similar posts');\n            }\n            \n            // Show appropriate notification\n            showNotification('Similar search started - results will be saved to your browser', 'info');\n            \n        } catch (error) {\n            console.error('Failed to find similar:', error);\n            showNotification(error.message || 'Failed to find similar posts', 'error');\n            removeNotification(similarNotificationId.current);\n        }\n    };\n\n    const handleTagSearch = async (query) => {\n        if (!query || !query.trim()) {\n            showNotification('Please enter a tag to search', 'info');\n            return;\n        }\n        \n        let notificationId = tagSearchNotificationId.current;\n        if (!notificationId) {\n            notificationId = `tag_search-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`;\n            tagSearchNotificationId.current = notificationId;\n        }\n        \n        try {\n            showProgressNotification(notificationId, 'Searching for tags...', 0, false);\n            \n            // Convert contentFilter string to numeric value\n            const contentFilterValue = contentFilter === 'sfw' ? 0 : 1;\n\n            const headers = {\n                'Content-Type': 'application/json',\n                'x-guest-id': guestId.current\n            };\n\n            console.log('Guest user');\n            \n            const response = await fetch(`${API_URL}/api/search-tags`, {\n                method: 'POST',\n                headers: headers,\n                ...fetchConfig,\n                body: JSON.stringify({ \n                    query: query,\n                    contentType: contentFilterValue\n                }),\n            });\n\n            if (!response.ok) {\n                throw new Error('Failed to search tags');\n            }\n            \n            // Show notification for guest users\n            showNotification('Tag search started - results will be saved to your browser', 'info');\n            \n        } catch (error) {\n            console.error('Failed to search tags:', error);\n            showNotification(error.message || 'Failed to search tags', 'error');\n        }\n    };\n\n    const scrollToMedia = useCallback((index) => {\n        const mediaElement = mediaRefs.current[index];\n        if (mediaElement) {\n            mediaElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        }\n    }, []);\n\n    const handleMediaClick = useCallback((index) => {\n        if (!isClickable) return; // Prevent clicking if in cooldown\n        setFullscreenMedia(index);\n        console.log(\"HandleMediaClick was called\");\n        \n        // Pause all other videos first\n        mediaRefs.current.forEach((media, i) => {\n            if (media && i !== index && media.tagName === 'VIDEO') {\n                media.pause();\n                media.muted = true;\n            }\n        });\n\n        // Play the selected video and unmute it with a slight delay to ensure proper state\n        const selectedVideo = mediaRefs.current[index];\n        if (selectedVideo && selectedVideo.tagName === 'VIDEO') {\n            selectedVideo.muted = false;\n            selectedVideo.volume = globalVolume;\n            \n            // Use a timeout to ensure the video element is ready\n            setTimeout(() => {\n                selectedVideo.play().catch(err => {\n                    console.log('Autoplay prevented:', err);\n                    // Try to play again with user interaction context\n                    selectedVideo.muted = true;\n                    selectedVideo.play().then(() => {\n                        selectedVideo.muted = false;\n                    }).catch(secondErr => {\n                        console.log('Second autoplay attempt failed:', secondErr);\n                    });\n                });\n            }, 100);\n        }\n        \n        const mediaContainer = document.getElementById('media-container');\n        if (mediaContainer) {\n            mediaContainer.classList.add('fullscreen-active');\n        }\n        document.querySelectorAll('.postlink-icon, .close-icon, .remove-icon, .similar-icon, .tag, .tags-panel').forEach(button => {\n            button.style.zIndex = '1002';\n        });\n        scrollToMedia(index);\n    }, [isClickable, globalVolume, scrollToMedia]);\n\n    const handleMediaClose = useCallback(() => {\n        setFullscreenMedia(null);\n        setIsClickable(false); // Disable clicking\n       \n        // Resume playing only videos that are currently in view, but keep them muted\n        mediaRefs.current.forEach((media, index) => {\n            if (media && media.tagName === 'VIDEO') {\n                // Check if the video element is in the viewport\n                const rect = media.getBoundingClientRect();\n                const isInViewport = (\n                    rect.top >= 0 &&\n                    rect.left >= 0 &&\n                    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n                    rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n                );\n                \n                if (isInViewport) {\n                    media.muted = true;\n                    media.volume = globalVolume;\n                    media.play().catch(err => {\n                        console.log('Autoplay prevented:', err);\n                    });\n                } else {\n                    // Pause videos that are not in view\n                    media.pause();\n                }\n            }\n        });\n\n        const mediaContainer = document.getElementById('media-container');\n        if (mediaContainer) {\n            mediaContainer.classList.remove('fullscreen-active');\n        }\n        document.querySelectorAll('.postlink-icon, .close-icon, .remove-icon').forEach(button => {\n            button.style.zIndex = '';\n        });\n        \n        // Enable clicking after 500ms (0.5 seconds)\n        setTimeout(() => {\n            setIsClickable(true);\n        }, 100);\n    }, [globalVolume]);\n\n    const handleClickOutside = useCallback((event) => {\n        if (fullscreenMedia !== null && !mediaRefs.current[fullscreenMedia]?.contains(event.target) && !event.target.closest('.postlink-icon, .close-icon, .remove-icon, .scrape-button, .auto-scroll-button, .similar-icon, .tag, .tags-panel')) {\n            handleMediaClose();\n        }\n        \n        // Close mobile menu when clicking outside\n        if (isMobile && showMobileMenu && !event.target.closest('.mobile-menu-container, .mobile-menu-button, .mobile-dropdown-menu')) {\n            setShowMobileMenu(false);\n        }\n    }, [fullscreenMedia, isMobile, showMobileMenu, handleMediaClose]);\n\n    const handleKeyPress = useCallback((e) => {\n        if (fullscreenMedia === null) return;\n\n        if (e.key === 'ArrowDown') {\n            const nextIndex = (fullscreenMedia + 1) % mediaUrls.length;\n            \n            // Pause current video\n            const currentMedia = mediaRefs.current[fullscreenMedia];\n            if (currentMedia && currentMedia.tagName === 'VIDEO') {\n                currentMedia.pause();\n                currentMedia.muted = true;\n            }\n            \n            setFullscreenMedia(nextIndex);\n            \n            // Play next video\n            const nextMedia = mediaRefs.current[nextIndex];\n            if (nextMedia && nextMedia.tagName === 'VIDEO') {\n                nextMedia.muted = false;\n                nextMedia.volume = globalVolume;\n                setTimeout(() => {\n                    nextMedia.play().catch(err => {\n                        console.log('Autoplay prevented:', err);\n                        // Fallback: try muted first\n                        nextMedia.muted = true;\n                        nextMedia.play().then(() => {\n                            nextMedia.muted = false;\n                        }).catch(() => {});\n                    });\n                }, 100);\n            }\n            scrollToMedia(nextIndex);\n        } else if (e.key === 'ArrowUp') {\n            const prevIndex = (fullscreenMedia - 1 + mediaUrls.length) % mediaUrls.length;\n            \n            // Pause current video\n            const currentMedia = mediaRefs.current[fullscreenMedia];\n            if (currentMedia && currentMedia.tagName === 'VIDEO') {\n                currentMedia.pause();\n                currentMedia.muted = true;\n            }\n            \n            setFullscreenMedia(prevIndex);\n            \n            // Play previous video\n            const prevMedia = mediaRefs.current[prevIndex];\n            if (prevMedia && prevMedia.tagName === 'VIDEO') {\n                prevMedia.muted = false;\n                prevMedia.volume = globalVolume;\n                setTimeout(() => {\n                    prevMedia.play().catch(err => {\n                        console.log('Autoplay prevented:', err);\n                        // Fallback: try muted first\n                        prevMedia.muted = true;\n                        prevMedia.play().then(() => {\n                            prevMedia.muted = false;\n                        }).catch(() => {});\n                    });\n                }, 100);\n            }\n            scrollToMedia(prevIndex);\n        }\n    }, [fullscreenMedia, mediaUrls.length, scrollToMedia, globalVolume]);\n\n\n\n    // Debounced function to handle page increment\n    const debouncedPageIncrement = useCallback(() => {\n        const timeoutId = setTimeout(() => {\n            setCurrentPage(prevPage => prevPage + 1);\n        }, 300);\n        return () => clearTimeout(timeoutId);\n    }, []);\n\n    const lastMediaElementRef = useCallback(node => {\n        if (!node) return;\n        \n        if (observer.current) observer.current.disconnect();\n        observer.current = new IntersectionObserver(entries => {\n            if (entries.some(entry => entry.isIntersecting)) {\n               debouncedPageIncrement();\n            }\n        }, { \n            threshold: 0.1,\n            rootMargin: autoScroll ? '300px' : '100px' // Larger margin during auto-scroll\n        });\n                           \n        const lastColumnItems = document.querySelectorAll('.masonry-grid_column > div:last-child');\n        lastColumnItems.forEach(item => {\n            observer.current.observe(item);\n        });\n        \n        // Also observe the provided node\n        observer.current.observe(node);\n    }, [autoScroll, debouncedPageIncrement]); // Add debouncedPageIncrement dependency\n\n    // Handle window resize for responsive behavior\n    useEffect(() => {\n        const handleResize = () => {\n            const isMobileView = window.innerWidth <= 700; // Adjust breakpoint as needed\n            setIsMobile(isMobileView);\n            if (!isMobileView) {\n                setShowMobileMenu(false); // Close mobile menu when switching to desktop\n            }\n        };\n\n        // Set initial state\n        handleResize();\n\n        // Add event listener\n        window.addEventListener('resize', handleResize);\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n\n    // Konami Code detection for hidden NSFW toggle\n    useEffect(() => {\n        const handleKonamiKeyPress = (e) => {\n            // Only track konami when not in fullscreen to avoid conflicts\n            if (fullscreenMedia !== null) return;\n            // Ignore if typing in input fields\n            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n            \n            setKonamiSequence(prev => {\n                const newSequence = [...prev, e.code].slice(-konamiCode.length);\n                \n                // Check if sequence matches konami code\n                if (newSequence.length === konamiCode.length && \n                    newSequence.every((key, index) => key === konamiCode[index])) {\n                    const newFilter = contentFilter === 'sfw' ? 'nsfw' : 'sfw';\n                    setContentFilter(newFilter);\n                    saveContentFilterPreference(newFilter);\n                    showNotification(`🎮 Konami activated! Content: ${newFilter.toUpperCase()}`, 'success');\n                    return []; // Reset sequence\n                }\n                \n                return newSequence;\n            });\n        };\n\n        document.addEventListener('keydown', handleKonamiKeyPress);\n        return () => document.removeEventListener('keydown', handleKonamiKeyPress);\n    }, [fullscreenMedia, contentFilter, konamiCode]);\n\n    useEffect(() => {\n        setCurrentPage(1);\n        setMediaUrls([]);\n        fetchMedia(1, initialMediaPerPage);\n    }, [filter, tagFilter, tagBlacklist, fetchMedia]);\n\n    useEffect(() => {\n        fetchMedia(currentPage, mediaPerPage);\n    }, [currentPage, fetchMedia]);\n\n    useEffect(() => {\n        document.addEventListener('mousedown', handleClickOutside);\n        document.addEventListener('keydown', handleKeyPress);\n        document.body.style.overflow = fullscreenMedia !== null ? 'hidden' : 'auto';\n        return () => {\n            document.removeEventListener('mousedown', handleClickOutside);\n            document.removeEventListener('keydown', handleKeyPress);\n            document.body.style.overflow = 'auto';\n        };\n    }, [fullscreenMedia, handleKeyPress, handleClickOutside]);\n\n    useEffect(() => {\n        if (autoScroll && fullscreenMedia !== null) {\n            const currentMedia = mediaRefs.current[fullscreenMedia];\n            const videoDuration = currentMedia && currentMedia.tagName === 'VIDEO' ? currentMedia.duration * 1000 : 10000;\n            const timeoutId = setTimeout(() => {\n                const nextIndex = (fullscreenMedia + 1) % mediaUrls.length;\n                \n                // Pause current video\n                if (currentMedia && currentMedia.tagName === 'VIDEO') {\n                    currentMedia.pause();\n                    currentMedia.muted = true;\n                }\n                \n                setFullscreenMedia(nextIndex);\n                \n                // Play next video\n                const nextMedia = mediaRefs.current[nextIndex];\n                if (nextMedia && nextMedia.tagName === 'VIDEO') {\n                    nextMedia.muted = false;\n                    nextMedia.volume = globalVolume;\n                    setTimeout(() => {\n                        nextMedia.play().catch(err => {\n                            console.log('Auto-scroll autoplay prevented:', err);\n                            // Fallback: try muted first\n                            nextMedia.muted = true;\n                            nextMedia.play().then(() => {\n                                nextMedia.muted = false;\n                            }).catch(() => {});\n                        });\n                    }, 100);\n                }\n            }, videoDuration <= 1 ? videoDuration * 5 : videoDuration);\n            return () => clearTimeout(timeoutId);\n        }\n    }, [fullscreenMedia, mediaUrls, autoScroll, globalVolume]);\n\n    useEffect(() => {\n        if (autoScroll && fullscreenMedia === null && !loading) {\n            // Use CSS scroll-behavior for smooth scrolling\n            document.documentElement.style.scrollBehavior = 'auto';\n            \n            // Calculate scroll distance based on viewport height\n            const scrollDistance = Math.max(1, scrollSpeed * 1);\n            \n            const smoothScroll = () => {\n                // Get current scroll position\n                const currentScroll = window.pageYOffset;\n                const maxScroll = document.documentElement.scrollHeight - window.innerHeight;\n                \n                // Check if we've reached the bottom\n                if (currentScroll >= maxScroll - 10) {\n                    // Reached bottom, you could implement wrap-around or stop here\n                    return;\n                }\n                \n                // Use smooth scrollTo instead of scrollBy\n                window.scrollTo({\n                    top: currentScroll + scrollDistance,\n                    behavior: 'auto'\n                });\n                \n                scrollAnimation.current = requestAnimationFrame(smoothScroll);\n            };\n            \n            // Start with a small delay to prevent immediate scrolling\n            const timeoutId = setTimeout(() => {\n                scrollAnimation.current = requestAnimationFrame(smoothScroll);\n            }, 100);\n            \n            return () => {\n                clearTimeout(timeoutId);\n                if (scrollAnimation.current) {\n                    cancelAnimationFrame(scrollAnimation.current);\n                }\n                // Reset scroll behavior\n                document.documentElement.style.scrollBehavior = '';\n            };\n        }\n    }, [autoScroll, fullscreenMedia, scrollSpeed, loading]);\n\n    useEffect(() => {\n        setRandomSeed(Date.now());\n    }, [filter]);\n\n    useEffect(() => {\n        const script = document.createElement('script');\n        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js';\n        script.async = true;\n        document.body.appendChild(script);\n\n        return () => {\n            document.body.removeChild(script);\n        };\n    }, []);\n\n    const seedrandom = (seed) => {\n        if (window.Math.seedrandom) {\n            return new window.Math.seedrandom(seed);\n        }\n        return () => Math.random();\n    };\n\n    const selectedMedia = useMemo(() => {\n        const startIndex = (currentPage - 1) * mediaPerPage;\n        return mediaUrls.slice(0, startIndex + (2 * mediaPerPage));\n    }, [currentPage, mediaUrls, mediaPerPage]);\n\n    const handleIconClick = (url) => window.open(url, '_blank');\n\n    const handleScroll = useCallback(() => {\n        const currentScrollY = window.scrollY;\n        \n        if (currentScrollY < 50) {\n            prevScrollY.current = currentScrollY;\n            return;\n        }\n        \n        prevScrollY.current = currentScrollY;\n    }, []);\n\n    useEffect(() => {\n        let scrollTimeout;\n        \n        const onScroll = () => {\n            if (scrollTimeout) return;\n            scrollTimeout = setTimeout(() => {\n                handleScroll();\n                scrollTimeout = null;\n            }, 200);\n        };\n        \n        window.addEventListener('scroll', onScroll);\n        return () => window.removeEventListener('scroll', onScroll);\n    }, [handleScroll]);\n\n    const breakpointColumnsObj = useMemo(() => ({\n        default: 4,\n        1100: 3,\n        700: 2,\n        500: 1\n    }), []);\n\n    const handleImageError = (e, link, index) => {\n        console.error('Image failed to load:', e);\n        e.target.style.display = 'none'; // Hide the broken image\n        \n        // If in fullscreen and all media in this item failed to display, move to next\n        if (fullscreenMedia === index) {\n            const mediaItem = mediaUrls[index];\n            const allMediaFailed = mediaItem[1].every(mediaLink => {\n                const mediaElement = Array.from(document.querySelectorAll(`img[src=\"${mediaLink}\"], video[src=\"${mediaLink}\"]`));\n                return mediaElement.every(el => el.style.display === 'none');\n            });\n            \n            if (allMediaFailed) {\n                const nextIndex = (index + 1) % mediaUrls.length;\n                setFullscreenMedia(nextIndex);\n                const nextMedia = mediaRefs.current[nextIndex];\n                if (nextMedia && nextMedia.tagName === 'VIDEO') {\n                    nextMedia.play().catch(() => {});\n                }\n            }\n        }\n    };\n\n    const handleVideoError = async (e) => {\n        console.error('Video failed to load:', e);\n        if (e.target.error.code === 4) { // 404 error\n            e.target.style.display = 'none'; // Hide the broken video\n            \n            // Get the index from the video element's reference in mediaRefs\n            const index = Object.keys(mediaRefs.current).find(key => \n                mediaRefs.current[key] === e.target\n            );\n            \n            if (fullscreenMedia === Number(index)) {\n                const nextIndex = (Number(index) + 1) % mediaUrls.length;\n                setFullscreenMedia(nextIndex);\n                const nextMedia = mediaRefs.current[nextIndex];\n                if (nextMedia && nextMedia.tagName === 'VIDEO') {\n                    nextMedia.play().catch(() => {});\n                }\n            }\n        }\n    };\n\n    // Add this function to handle saving filter preference\n    const saveFilterPreference = (filterValue) => {\n        document.cookie = `preferred_filter=${filterValue}; max-age=31536000; path=/`; // Expires in 1 year\n    };\n\n    // Add this function to get filter from cookie\n    const getFilterFromCookie = () => {\n        const match = document.cookie.match(/preferred_filter=([^;]+)/);\n        return match ? match[1] : 'default';\n    };\n\n    const saveScrollSpeedPreference = (speed) => {\n        document.cookie = `preferred_scroll_speed=${speed}; max-age=31536000; path=/`;\n    };\n\n    const getScrollSpeedFromCookie = () => {\n        const match = document.cookie.match(/preferred_scroll_speed=([^;]+)/);\n        return match ? parseFloat(match[1]) : 1;\n    };\n\n    const saveVolumePreference = (volume) => {\n        document.cookie = `preferred_volume=${volume}; max-age=31536000; path=/`;\n    };\n\n    const saveShowDefaultLinksPreference = (show) => {\n        document.cookie = `show_default_links=${show ? '1' : '0'}; max-age=31536000; path=/`;\n    };\n\n    const getShowDefaultLinksFromCookie = () => {\n        const match = document.cookie.match(/show_default_links=([^;]+)/);\n        return match ? match[1] === '1' : false;\n    };\n\n    // Add new functions for content filter preference\n    const saveContentFilterPreference = (filter) => {\n        document.cookie = `content_filter=${filter}; max-age=31536000; path=/`;\n    };\n\n    const getContentFilterFromCookie = () => {\n        const match = document.cookie.match(/content_filter=([^;]+)/);\n        return match ? match[1] : 'sfw';\n    };\n\n    // Add new functions for tag blacklist preference\n    const saveTagBlacklistPreference = (blacklist) => {\n        document.cookie = `tag_blacklist=${encodeURIComponent(blacklist)}; max-age=31536000; path=/`;\n    };\n\n    const getTagBlacklistFromCookie = () => {\n        const match = document.cookie.match(/tag_blacklist=([^;]+)/);\n        return match ? decodeURIComponent(match[1]) : '';\n    };\n\n    // Add new functions for auto scroll preference\n    const saveAutoScrollPreference = (autoScroll) => {\n        document.cookie = `auto_scroll=${autoScroll ? '1' : '0'}; max-age=31536000; path=/`;\n    };\n\n    const getAutoScrollFromCookie = () => {\n        const match = document.cookie.match(/auto_scroll=([^;]+)/);\n        return match ? match[1] === '1' : false;\n    };\n\n    const handleFilterChange = (newFilter) => {\n        setFilter(newFilter);\n        saveFilterPreference(newFilter);\n        setRandomSeed(Date.now()); // Ensure random seed is updated when filter changes\n        \n        // Reset pagination and reload content\n        setCurrentPage(1);\n        setMediaUrls([]);\n        // Don't call fetchMedia here to prevent recursion in useEffect dependencies\n    };\n\n    const loadPreferences = useCallback(() => {\n        // Load preferences from cookies\n        setScrollSpeed(getScrollSpeedFromCookie());\n        setShowDefaultLinks(getShowDefaultLinksFromCookie());\n        setContentFilter(getContentFilterFromCookie());\n        setAutoScroll(getAutoScrollFromCookie());\n        setTagBlacklist(getTagBlacklistFromCookie());\n        setFilter(getFilterFromCookie() || 'random');\n    }, []);\n\n    useEffect(() => {\n        // Load all saved preferences on component mount\n        const savedTagBlacklist = getTagBlacklistFromCookie();\n        setTagBlacklist(savedTagBlacklist);\n        \n        const savedShowDefaultLinks = getShowDefaultLinksFromCookie();\n        setShowDefaultLinks(savedShowDefaultLinks);\n        \n        const savedContentFilter = getContentFilterFromCookie();\n        setContentFilter(savedContentFilter);\n        \n        const savedActiveCollection = getActiveCollectionFromCookie();\n        setActiveCollection(savedActiveCollection);\n    }, []);\n\n    useEffect(() => {\n        Object.values(mediaRefs.current).forEach(ref => {\n            if (ref && ref.tagName === 'VIDEO') {\n                ref.volume = globalVolume;\n            }\n        });\n    }, [globalVolume]);\n\n    const handleExport = async () => {\n        try {\n            // Export the active collection from localStorage\n            const currentCollection = collections.find(c => c.id === activeCollection);\n            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n            const localData = getFromLocalStorage(storageKey);\n            \n            if (localData && localData.length > 0) {\n                const dataStr = JSON.stringify(localData, null, 2);\n                const dataBlob = new Blob([dataStr], { type: 'application/json' });\n                const url = URL.createObjectURL(dataBlob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `kupo-nuts-${currentCollection.id}-collection.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                URL.revokeObjectURL(url);\n                showNotification(`${currentCollection.name} collection exported successfully`, 'success');\n            } else {\n                showNotification(`No items in ${currentCollection.name} collection to export`, 'info');\n            }\n        } catch (error) {\n            console.error('Export error:', error);\n            showNotification(error.message || 'Failed to export collection', 'error');\n        }\n    };\n\n    const handleImport = async (event) => {\n        try {\n            const file = event.target.files[0];\n            if (!file) return;\n\n            const reader = new FileReader();\n            reader.onload = async (e) => {\n                try {\n                    let content = JSON.parse(e.target.result);\n                    \n                    // Convert old format if necessary\n                    if (!Array.isArray(content)) {\n                        content = Object.entries(content).map(([postLink, videoLinks]) => ({\n                            postLink,\n                            videoLinks: Array.isArray(videoLinks) ? videoLinks : [videoLinks]\n                        }));\n                    }\n\n                    // Validate content structure\n                    const validContent = content.filter(item => {\n                        return item && \n                               typeof item === 'object' && \n                               typeof item.postLink === 'string' && \n                               (Array.isArray(item.videoLinks) || typeof item.videoLinks === 'string');\n                    });\n\n                    if (validContent.length === 0) {\n                        throw new Error('No valid media links found in file');\n                    }\n\n                    // Import to localStorage using active collection\n                    const currentCollection = collections.find(c => c.id === activeCollection);\n                    const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n                    saveToLocalStorage(validContent, storageKey);\n                    showNotification(`Successfully imported ${validContent.length} links to ${currentCollection.name} collection`, 'success');\n                    \n                    // Refresh the display\n                    setCurrentPage(1);\n                    setMediaUrls([]);\n                    await fetchMedia(1, initialMediaPerPage);\n                    \n                } catch (error) {\n                    console.error('Import error:', error);\n                    showNotification(error.message || 'Invalid file format', 'error');\n                }\n            };\n            reader.readAsText(file);\n        } catch (error) {\n            console.error('File reading error:', error);\n            showNotification('Failed to read import file', 'error');\n        }\n        // Reset file input\n        event.target.value = '';\n    };\n\n\n\n    // Add function to mark media as loaded\n    const handleMediaLoad = (index) => {\n        setLoadedMedia(prev => ({\n            ...prev,\n            [index]: true\n        }));\n    };\n\n    // Handle tag click for filtering\n    const handleTagClick = (tag, e) => {\n        e.stopPropagation(); // Prevent triggering the media click\n        \n        if (tagFilter === tag) {\n            // If clicking the same tag again, clear the filter\n            setTagFilter(null);\n        } else {\n            // Set the new tag filter (replacing any existing filter)\n            const query = tag; // Use the tag directly\n            setTagSearchQuery(query);\n            setTagFilter(query);\n            handleTagSearch(query);\n        }\n        \n        // Close fullscreen view when setting a tag filter\n        if (fullscreenMedia !== null) {\n            handleMediaClose();\n        }\n        \n        // Reset to page 1 when changing filters\n        setCurrentPage(1);\n        setMediaUrls([]);\n        \n        // Scroll to top when filtering or clearing tags\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n    };\n\n    // Handle adding tag to current filter\n    const handleAddTagToFilter = (tag, e) => {\n        e.stopPropagation(); // Prevent triggering the media click\n        \n        if (!tagFilter) {\n            // If no current filter, just set this tag\n            handleTagClick(tag, e);\n        } else if (!tagFilter.includes(tag)) {\n            // Only add if tag isn't already in filter\n            const combinedFilter = `${tagFilter} + ${tag}`;\n            setTagSearchQuery(combinedFilter);\n            setTagFilter(combinedFilter);\n            handleTagSearch(combinedFilter);\n            \n            // Reset to page 1 when changing filters\n            setCurrentPage(1);\n            setMediaUrls([]);\n            \n            // Scroll to top when adding tags\n            window.scrollTo({ top: 0, behavior: 'smooth' });\n        }\n    };\n\n    // Add a component for the tags panel that supports categorized tags\n    const TagsPanel = ({ tags }) => {\n        // Handle the case where tags is null or empty\n        if (!tags) return <div className=\"tags-panel\"><div className=\"tags-header\">No tags available</div></div>;\n        \n        // Convert old format (array) to new format (object with categories) if needed\n        const categorizedTags = Array.isArray(tags) ? { general: tags } : tags;\n        \n        // Check if we have any tags in any category\n        const hasTags = Object.values(categorizedTags).some(categoryTags => \n            Array.isArray(categoryTags) && categoryTags.length > 0\n        );\n        \n        if (!hasTags) return <div className=\"tags-panel\"><div className=\"tags-header\">No tags available</div></div>;\n        \n        // Define category display order and labels\n        const categories = [\n            { key: 'author', label: 'Artists' },\n            { key: 'copyright', label: 'Copyright' },\n            { key: 'character', label: 'Characters' },\n            { key: 'general', label: 'General' }\n        ];\n        \n        const addTagToBlacklist = (tag, e) => {\n            e.stopPropagation(); // Prevent triggering the media click\n            \n            // Get current blacklist and add the new tag\n            let currentBlacklist = tagBlacklist ? tagBlacklist.split(',').map(t => t.trim()) : [];\n            // Make sure we don't add duplicates\n            if (!currentBlacklist.includes(tag)) {\n                currentBlacklist.push(tag);\n                const newBlacklist = currentBlacklist.join(', ');\n                setTagBlacklist(newBlacklist);\n                saveTagBlacklistPreference(newBlacklist);\n                showNotification(`Added \"${tag}\" to blacklist`, 'info');\n            } else {\n                showNotification(`\"${tag}\" is already in blacklist`, 'info');\n            }\n        };\n        \n        return (\n            <div className=\"tags-panel\">\n                <div className=\"tags-header\">\n                    Tags\n                </div>\n                \n                {categories.map(category => {\n                    const categoryTags = categorizedTags[category.key];\n                    if (!categoryTags || categoryTags.length === 0) return null;\n                    \n                    return (\n                        <div key={category.key} className=\"tag-category\">\n                            <h3 className=\"tag-category-header\">{category.label}</h3>\n                            <div className=\"tags-list\">\n                                {categoryTags.map((tag, idx) => (\n                                    <div \n                                        key={`${category.key}-${idx}`}\n                                        className={`tag-container`}\n                                    >\n                                        <span \n                                            className={`tag tag-${category.key} ${tagFilter === tag ? 'active' : ''}`}\n                                            onClick={(e) => handleTagClick(tag, e)}\n                                        >\n                                            {tag}\n                                        </span>\n                                        <div className=\"tag-actions\">\n                                            <button \n                                                className=\"tag-action tag-action-plus\" \n                                                onClick={(e) => handleAddTagToFilter(tag, e)}\n                                                title=\"Filter by this tag\"\n                                            >\n                                                <i className=\"fas fa-plus\"></i>\n                                            </button>\n                                            <button \n                                                className=\"tag-action tag-action-minus\" \n                                                onClick={(e) => addTagToBlacklist(tag, e)}\n                                                title=\"Add to blacklist\"\n                                            >\n                                                <i className=\"fas fa-minus\"></i>\n                                            </button>\n                                        </div>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    );\n                })}\n            </div>\n        );\n    };\n\n    useEffect(() => {\n        // Store the guest ID in localStorage for persistence\n        localStorage.setItem('kupoguestid', guestId.current);\n        \n        // Load preferences on component mount\n        loadPreferences();\n        \n        const setupSocket = () => {\n            const newSocket = io(API_URL, {\n                withCredentials: true,\n                transports: ['websocket', 'polling'],\n                reconnection: true,\n                reconnectionAttempts: 10,\n                reconnectionDelay: 1000,\n                reconnectionDelayMax: 5000,\n                timeout: 20000\n            });\n            \n            newSocket.on('connect', () => {\n                console.log('Connected');\n                // Always authenticate as a guest\n                newSocket.emit('authenticate', { isGuest: true, guestId: guestId.current });\n            });\n            \n            const handleProgressEvent = (data, type) => {\n                \n                let notificationIdRef;\n                switch (type) {\n                    case 'scrape':\n                        notificationIdRef = scrapeNotificationId;\n                        break;\n                    case 'similar':\n                        notificationIdRef = similarNotificationId;\n                        break;\n                    case 'tag_search':\n                        notificationIdRef = tagSearchNotificationId;\n                        break;\n                    default:\n                        notificationIdRef = scrapeNotificationId;\n                }\n                \n                if (!notificationIdRef.current) {\n                    // Create a more unique ID for progress notifications\n                    notificationIdRef.current = `${type}-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`;\n                }\n                \n                setNotifications(prevNotifications => {\n                    const currentNotification = prevNotifications.find(n => n.id === notificationIdRef.current);\n                    \n                    const totalLinksAdded = currentNotification?.linksAdded || 0;\n                    const newLinksCount = data.newItems?.length || 0;\n                    \n                    const updatedLinksAdded = data.count !== undefined ? \n                        data.count :\n                        (totalLinksAdded + newLinksCount);\n                    \n                    const typeLabel = type.split('_')\n                        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n                        .join(' ');\n                    \n                    let linkCountMessage;\n                    if (data.isComplete) {\n                        linkCountMessage = `${typeLabel}: ${updatedLinksAdded} links found`;\n                    } else if (updatedLinksAdded > 0) {\n                        linkCountMessage = `${typeLabel}: ${updatedLinksAdded} links found so far`;\n                    } else {\n                        linkCountMessage = `${typeLabel}: ${data.message || 'Processing...'}`;\n                    }\n                    \n                    const updated = currentNotification \n                        ? prevNotifications.map(n => n.id === notificationIdRef.current ? {\n                            ...n,\n                            message: linkCountMessage,\n                            count: data.count !== undefined ? data.count : n.count || 0,\n                            isComplete: data.isComplete,\n                            linksAdded: updatedLinksAdded\n                        } : n)\n                        : [...prevNotifications, {\n                            id: notificationIdRef.current,\n                            message: linkCountMessage,\n                            type: 'progress',\n                            count: data.count || 0,\n                            isComplete: data.isComplete,\n                            linksAdded: updatedLinksAdded\n                        }];\n                    \n                    return updated;\n                });\n                \n                if (data.isComplete) {\n                    setTimeout(() => {\n                        const currentId = notificationIdRef.current;\n                        notificationIdRef.current = null;\n                        \n                        \n                        setNotifications(prev => prev.filter(n => n.id !== currentId));\n                    }, 3000);\n                }\n                \n                if (data.newItems && data.newItems.length > 0) {\n                    try {\n                        setMediaUrls(prevMediaUrls => {\n                            let formattedItems = data.newItems.map(item => [\n                                item.postLink || '',\n                                item.videoLinks || [],\n                                item.tags || {}\n                            ]);\n                            \n                            // Add to localStorage\n                            const currentCollection = collections.find(c => c.id === activeCollection);\n                            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n                            \n                            data.newItems.forEach(item => {\n                                // Use the active collection's storage key\n                                addToLocalStorage(item, storageKey);\n                            });\n\n                            return [...prevMediaUrls, ...formattedItems];\n                        });\n                        \n                    } catch (error) {\n                        console.error(`Error processing new ${type} items:`, error);\n                    }\n                }\n            };\n            \n            newSocket.on('scrape_progress', (data) => handleProgressEvent(data, 'scrape'));\n            newSocket.on('similar_progress', (data) => handleProgressEvent(data, 'similar'));\n            newSocket.on('tag_search_progress', (data) => handleProgressEvent(data, 'tag_search'));\n            \n            newSocket.on('error', (error) => {\n                console.error('WebSocket error:', error);\n                showNotification('WebSocket error. Some features may be affected.', 'error');\n            });\n\n            newSocket.on('reconnect', () => {\n                // Always authenticate as guest on reconnect\n                newSocket.emit('authenticate', { isGuest: true, guestId: guestId.current });\n                showNotification('WebSocket reconnected', 'success');\n            });\n            \n            newSocket.on('reconnect_error', (error) => {\n                console.error('WebSocket reconnect error:', error);\n                showNotification('Failed to reconnect WebSocket', 'error');\n            });\n            \n            return newSocket;\n        };\n        \n        // Create socket connection\n        const newSocket = setupSocket();\n        setSocket(newSocket);\n        \n        return () => {\n            if (newSocket) {\n                newSocket.disconnect();\n            }\n        };\n        \n    }, [loadPreferences, activeCollection, collections]); // Removed API_URL dependency\n\n    const handleSettingsOpen = () => {\n        setShowSettings(true);\n    };\n\n    const handleClearCollection = () => {\n        setShowConfirmClear(true);\n    };\n\n    const confirmClearCollection = () => {\n        try {\n            // Clear from localStorage for the active collection\n            const currentCollection = collections.find(c => c.id === activeCollection);\n            const storageKey = currentCollection?.storageKey || LOCAL_STORAGE_KEY;\n            localStorage.removeItem(storageKey);\n            setMediaUrls([]);\n            showNotification(`${currentCollection.name} collection cleared`, 'success');\n            setShowConfirmClear(false);\n        } catch (error) {\n            console.error('Error clearing collection:', error);\n            showNotification('Failed to clear collection', 'error');\n        } finally {\n            // Reset media URLs to default\n            const defaultMediaLinks = defaultLinks.map(item => [item.postLink || '', item.videoLinks, item.tags || {}]);\n            setMediaUrls(defaultMediaLinks);\n        }\n    };\n\n    const cancelClearCollection = () => {\n        setShowConfirmClear(false);\n    };\n\n    const handleTagBlacklistChange = (event) => {\n        const newBlacklist = event.target.value;\n        setTagBlacklist(newBlacklist);\n        saveTagBlacklistPreference(newBlacklist);\n    };\n\n    const handleDeleteBlacklisted = () => {\n        try {\n            const blacklist = tagBlacklist.split(',').map(tag => tag.trim().toLowerCase());\n            const filteredMedia = mediaUrls.filter(media => {\n                const tags = media[2];\n                if (!tags) return true;\n                const allTags = [];\n                if (Array.isArray(tags)) {\n                    tags.forEach(tag => allTags.push(tag.toLowerCase()));\n                } else {\n                    Object.values(tags).forEach(categoryTags => {\n                        if (Array.isArray(categoryTags)) {\n                            categoryTags.forEach(tag => allTags.push(tag.toLowerCase()));\n                        }\n                    });\n                }\n                return !blacklist.some(blacklistedTag =>\n                    allTags.some(tag => tag.includes(blacklistedTag))\n                );\n            });\n            setMediaUrls(filteredMedia);\n            showNotification('Deleted all media containing blacklisted tags', 'success');\n        } catch (error) {\n            console.error('Error deleting blacklisted media:', error);\n            showNotification('Failed to delete blacklisted media', 'error');\n        }\n    };\n\n    const handleUnifiedSearch = () => {\n        if (searchQuery.trim().toLowerCase().startsWith('http')) {\n            // It's a URL, trigger scraping\n            \n            // Handle special cases\n            if (searchQuery.includes('❤️')) {\n                scrapeSavedLinks();\n            } else {\n                handleScrape(searchQuery.trim()); // Pass URL directly\n            }\n        } else {\n            // It's a tag, trigger tag search\n            const query = searchQuery.trim();\n            setTagSearchQuery(query);\n            handleTagSearch(query);\n        }\n        \n        // Clear the search input\n        setSearchQuery('');\n    };\n\n    // Add a new ref to store video observers\n    const videoObservers = useRef({});\n\n    // Create a function to handle visibility changes for videos\n    const handleVideoVisibilityChange = useCallback((entries, observer) => {\n        entries.forEach(entry => {\n            const video = entry.target;\n            \n            // If video is intersecting (visible in viewport)\n            if (entry.isIntersecting) {\n                // Only play if not in fullscreen mode and autoplay is enabled\n                if (fullscreenMedia === null && video.tagName === 'VIDEO') {\n                    video.play().catch(err => {\n                        // Silent catch for autoplay restrictions\n                        console.log('Autoplay prevented:', err);\n                    });\n                }\n            } else {\n                // If video is not visible and not the fullscreen video, pause it\n                if (fullscreenMedia === null && video.tagName === 'VIDEO') {\n                    video.pause();\n                }\n            }\n        });\n    }, [fullscreenMedia]);\n\n    // Function to setup observers for all video elements\n        const setupVideoObservers = useCallback(() => {\n            // Skip if currently loading to avoid performance issues\n            if (loading) return;\n            \n            // Clean up any existing observers more efficiently\n            Object.values(videoObservers.current).forEach(observer => {\n                if (observer) observer.disconnect();\n            });\n            \n            // Clear the observers object\n            videoObservers.current = {};\n            \n            // Setup new observers for all video elements (except fullscreen video)\n            Object.entries(mediaRefs.current).forEach(([index, ref]) => {\n                if (ref && ref.tagName === 'VIDEO' && parseInt(index) !== fullscreenMedia) {\n                    const observer = new IntersectionObserver(\n                        handleVideoVisibilityChange, \n                        {\n                            root: null, // viewport\n                            threshold: 0.2, // 20% visibility triggers callback\n                            rootMargin: '50px' // Add margin to reduce frequent triggering\n                        }\n                    );\n                    \n                    observer.observe(ref);\n                    videoObservers.current[index] = observer;\n                }\n            });\n        }, [handleVideoVisibilityChange, fullscreenMedia, loading]);\n\n    // Setup video observers when media refs change\n    useEffect(() => {\n        // Only setup observers if not currently loading to avoid interrupting autoscroll\n        if (!loading) {\n            const timer = setTimeout(() => {\n                setupVideoObservers();\n            }, 1000); // Increased delay to let loading settle\n            \n            return () => {\n                clearTimeout(timer);\n                // Clean up observers on unmount\n                Object.values(videoObservers.current).forEach(observer => {\n                    if (observer) observer.disconnect();\n                });\n            };\n        }\n    }, [mediaUrls.length, setupVideoObservers, loading]); // Added loading dependency\n\n    // Refresh video observers after page changes\n    useEffect(() => {\n        if (!loading) {\n            const timer = setTimeout(() => {\n                setupVideoObservers();\n            }, 1000);\n            \n            return () => clearTimeout(timer);\n        }\n    }, [currentPage, loading, setupVideoObservers]);\n\n    // Refresh video observers when fullscreen changes\n    useEffect(() => {\n        if (!loading) {\n            const timer = setTimeout(() => {\n                setupVideoObservers();\n            }, 500);\n            \n            return () => clearTimeout(timer);\n        }\n    }, [fullscreenMedia, setupVideoObservers, loading]);\n\n\n\n    const handleCollectionSwitch = (collectionId) => {\n        if (collectionId === activeCollection) return;\n        \n        // Complete reset of all media-related state\n        setActiveCollection(collectionId);\n        setCurrentPage(1);\n        setMediaUrls([]);\n        setLoadedMedia({}); // Reset loaded media state\n        setFullscreenMedia(null); // Close any fullscreen media\n        setTagFilter(null); // Clear any tag filters\n        setSearchQuery(''); // Clear search query\n        setTagSearchQuery(''); // Clear tag search query\n        mediaSet.current.clear();\n        \n        // Clear media refs\n        mediaRefs.current = [];\n        \n        // Scroll to top when switching collections\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n        \n        // Save preference\n        document.cookie = `active_collection=${collectionId}; max-age=31536000; path=/`;\n        \n        // Show notification\n        const collection = collections.find(c => c.id === collectionId);\n        if (collection) {\n            showNotification(`Switched to ${collection.name} collection`, 'success');\n        }\n        \n        // Reload content with the new collection\n        fetchMedia(1, initialMediaPerPage);\n    };\n\n    // Get active collection from cookie on init\n    const getActiveCollectionFromCookie = () => {\n        const match = document.cookie.match(/active_collection=([^;]+)/);\n        return match ? match[1] : 'main';\n    };\n\n    return (\n        <div>\n            <div className=\"top-search-bar\">\n                <div className=\"left-section\">\n                    <div \n                        className=\"app-title\"\n                        onClick={() => window.location.reload()}\n                        style={{ cursor: 'pointer' }}\n                    >\n                        <i className=\"fas fa-cat logo-icon\"></i>\n                        <span>Kupo Nuts</span>\n                    </div>\n                    \n                    {/* NSFW indicator - only visible when NSFW mode is active */}\n                    {contentFilter === 'nsfw' && (\n                        <button\n                            onClick={() => {\n                                setContentFilter('sfw');\n                                saveContentFilterPreference('sfw');\n                                showNotification('Content filter set to SFW', 'info');\n                            }}\n                            className=\"nsfw-indicator\"\n                            title=\"Click to switch to SFW mode\"\n                            style={{\n                                background: '#ff4757',\n                                color: 'white',\n                                border: 'none',\n                                padding: '8px 12px',\n                                borderRadius: '6px',\n                                fontSize: '16px',\n                                fontWeight: 'bold',\n                                cursor: 'pointer',\n                                marginLeft: '10px',\n                                animation: 'pulse 2s infinite'\n                            }}\n                        >\n                            🔞 NSFW\n                        </button>\n                    )}\n                    \n                    {!isMobile && (\n                        <>\n                            {/* NSFW button hidden - use Konami code ↑↑↓↓←→←→BA to toggle */}\n                            \n                            <div className=\"collection-tabs\">\n                                {collections.map(collection => (\n                                    <button\n                                        key={collection.id}\n                                        className={`collection-tab ${activeCollection === collection.id ? 'active' : ''}`}\n                                        onClick={() => handleCollectionSwitch(collection.id)}\n                                        title={`Switch to ${collection.name} collection`}\n                                    >\n                                        {collection.name}\n                                    </button>\n                                ))}\n                            </div>\n                        </>\n                    )}\n                </div>\n                \n                {isMobile ? (\n                    <div className=\"right-section\">\n                        <div className=\"mobile-search-and-menu\">\n                            <div className=\"mobile-search-container\">\n                                <input\n                                    type=\"text\"\n                                    value={searchQuery}\n                                    onChange={(e) => setSearchQuery(e.target.value)}\n                                    onKeyPress={(e) => e.key === 'Enter' && handleUnifiedSearch()}\n                                    placeholder=\"Search or URL...\"\n                                    className=\"search-input\"\n                                />\n                                <button\n                                    onClick={handleUnifiedSearch}\n                                    className=\"search-button\"\n                                >\n                                    <i className={`fas ${searchQuery.trim().toLowerCase().startsWith('http') ? 'fa-download' : 'fa-search'}`}></i>\n                                </button>\n                            </div>\n                            \n                            {/* NSFW indicator for mobile - only visible when NSFW mode is active */}\n                            {contentFilter === 'nsfw' && (\n                                <button\n                                    onClick={() => {\n                                        setContentFilter('sfw');\n                                        saveContentFilterPreference('sfw');\n                                        showNotification('Content filter set to SFW', 'info');\n                                    }}\n                                    className=\"nsfw-indicator mobile-nsfw\"\n                                    title=\"Click to switch to SFW mode\"\n                                    style={{\n                                        background: '#ff4757',\n                                        color: 'white',\n                                        border: 'none',\n                                        padding: '6px 10px',\n                                        borderRadius: '5px',\n                                        fontSize: '14px',\n                                        fontWeight: 'bold',\n                                        cursor: 'pointer',\n                                        marginLeft: '5px',\n                                        marginRight: '5px',\n                                        animation: 'pulse 2s infinite'\n                                    }}\n                                >\n                                    🔞\n                                </button>\n                            )}\n                            \n                            <div className=\"mobile-menu-container\">\n                                <button \n                                    className=\"mobile-menu-button\"\n                                    onClick={() => setShowMobileMenu(!showMobileMenu)}\n                                    aria-label=\"Open menu\"\n                                >\n                                    <i className=\"fas fa-bars\"></i>\n                                </button>\n                            \n                            {showMobileMenu && (\n                                <div className=\"mobile-dropdown-menu\">\n                                    {/* Content Filter hidden - use Konami code ↑↑↓↓←→←→BA to toggle */}\n                                    \n                                    <div className=\"mobile-menu-section\">\n                                        <div className=\"mobile-menu-header\">Collections</div>\n                                        {collections.map(collection => (\n                                            <button\n                                                key={collection.id}\n                                                className={`mobile-menu-item collection-item ${activeCollection === collection.id ? 'active' : ''}`}\n                                                onClick={() => {\n                                                    handleCollectionSwitch(collection.id);\n                                                    setShowMobileMenu(false);\n                                                }}\n                                            >\n                                                <i className=\"fas fa-folder\"></i>\n                                                {collection.name}\n                                                {activeCollection === collection.id && <i className=\"fas fa-check\"></i>}\n                                            </button>\n                                        ))}\n                                    </div>\n                                    \n                                    <div className=\"mobile-menu-section\">\n                                        <div className=\"mobile-menu-header\">Actions</div>\n                                        <button \n                                            className=\"mobile-menu-item\" \n                                            onClick={() => {\n                                                handleExport();\n                                                setShowMobileMenu(false);\n                                            }}\n                                        >\n                                            <i className=\"fas fa-download\"></i>\n                                            Export Collection\n                                        </button>\n                                        <button \n                                            className=\"mobile-menu-item\" \n                                            onClick={() => {\n                                                document.getElementById('top-import-file-input').click();\n                                                setShowMobileMenu(false);\n                                            }}\n                                        >\n                                            <i className=\"fas fa-upload\"></i>\n                                            Import Collection\n                                        </button>\n                                        <button \n                                            className=\"mobile-menu-item clear-item\" \n                                            onClick={() => {\n                                                handleClearCollection();\n                                                setShowMobileMenu(false);\n                                            }}\n                                        >\n                                            <i className=\"fas fa-trash\"></i>\n                                            Clear Collection\n                                        </button>\n                                    </div>\n                                </div>\n                            )}\n                            \n                            <input\n                                id=\"top-import-file-input\"\n                                type=\"file\"\n                                accept=\".json\"\n                                onChange={handleImport}\n                                style={{ display: 'none' }}\n                            />\n                        </div>\n                    </div>\n                    </div>\n                ) : (\n                    <>\n                        <div className=\"search-container\">\n                            <input\n                                type=\"text\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                onKeyPress={(e) => e.key === 'Enter' && handleUnifiedSearch()}\n                                placeholder=\"Enter tag to search or URL to scrape...\"\n                                className=\"search-input\"\n                            />\n                            <button\n                                onClick={handleUnifiedSearch}\n                                className=\"search-button\"\n                            >\n                                <i className={`fas ${searchQuery.trim().toLowerCase().startsWith('http') ? 'fa-download' : 'fa-search'}`}></i>\n                            </button>\n                        </div>\n\n                        <div className=\"right-section\">\n                            <div className=\"collection-management\">\n                                <button \n                                    className=\"collection-mgmt-btn export-btn\" \n                                    onClick={handleExport}\n                                    title=\"Export Collection\"\n                                >\n                                    <i className=\"fas fa-download\"></i>\n                                    <span>Export</span>\n                                </button>\n                                <button \n                                    className=\"collection-mgmt-btn import-btn\" \n                                    onClick={() => document.getElementById('top-import-file-input').click()}\n                                    title=\"Import Collection\"\n                                >\n                                    <i className=\"fas fa-upload\"></i>\n                                    <span>Import</span>\n                                </button>\n                                <input\n                                    id=\"top-import-file-input\"\n                                    type=\"file\"\n                                    accept=\".json\"\n                                    onChange={handleImport}\n                                    style={{ display: 'none' }}\n                                />\n                                <button \n                                    className=\"collection-mgmt-btn clear-btn\" \n                                    onClick={handleClearCollection}\n                                    title=\"Clear Collection\"\n                                >\n                                    <i className=\"fas fa-trash\"></i>\n                                    <span>Clear</span>\n                                </button>\n                            </div>\n                        </div>\n                    </>\n                )}\n            </div>\n            \n            {tagFilter && fullscreenMedia === null && (\n                <div className=\"active-filter-indicator\">\n                    <span>Filtering by: {tagFilter}</span>\n                    <button \n                        className=\"clear-button\" \n                        onClick={() => {\n                            setTagFilter(null);\n                            // Scroll to top when clearing filter\n                            window.scrollTo({ top: 0, behavior: 'smooth' });\n                        }}\n                        aria-label=\"Clear filter\"\n                    >\n                        <i className=\"fas fa-times\"></i>\n                    </button>\n                </div>\n            )}\n            <div className=\"notifications-container\">\n                {notifications.map((notification) => (\n                    <div \n                        key={notification.id} \n                        className={`notification ${notification.type}`}\n                        style={{ top: `${20 + (Array.from(notifications).findIndex(n => n.id === notification.id) * 70)}px` }}\n                    >\n                        <p className=\"notification-message\">{notification.message}</p>\n                        {notification.type === 'progress' && notification.isComplete && (\n                            <>\n                                <p className=\"notification-count\">\n                                    {notification.count} items found\n                                </p>\n                                <div \n                                    className=\"notification-progress-bar\" \n                                    style={{ width: '100%' }}\n                                />\n                            </>\n                        )}\n                        {notification.type === 'progress' && !notification.isComplete && (\n                            <div className=\"notification-loading\">\n                                <div className=\"notification-spinner\"></div>\n                            </div>\n                        )}\n                        {notification.type !== 'progress' && (\n                            <div className=\"notification-progress\" />\n                        )}\n                    </div>\n                ))}\n            </div>\n            <div className=\"main-content\">\n                <Masonry\n                    breakpointCols={breakpointColumnsObj}\n                    className=\"masonry-grid\"\n                    columnClassName=\"masonry-grid_column\"\n                >\n                    {selectedMedia && selectedMedia.map((media, index) => {\n                        const [postLink, videoLinks = [], tags] = media || [];\n                        if (!media || videoLinks.length === 0 || !videoLinks[0]) return null;\n                        const firstVideoLink = videoLinks && videoLinks[0];\n                        const isVideo = firstVideoLink && (firstVideoLink.endsWith('.mp4') || firstVideoLink.endsWith('.mov') || firstVideoLink.endsWith('.webm'));\n                        const isRule34Video = postLink && postLink.includes('rule34video');\n                        const embedUrl = firstVideoLink ? firstVideoLink.replace('/view/', '/embed/') : '';\n                        const isLoaded = loadedMedia[index];\n\n                        return (\n                            <div\n                                key={index}\n                                ref={index >= selectedMedia.length - breakpointColumnsObj.default ? lastMediaElementRef : null}\n                                className={`media-wrapper masonry-item ${fullscreenMedia === index ? 'fullscreen' : ''}`}\n                                onClick={() => handleMediaClick(index)}\n                            >\n                                {fullscreenMedia === index && <TagsPanel tags={tags} />}\n                                \n                                <div className={`media-container ${isLoaded ? 'media-loaded' : 'media-loading'}`}>\n                                    {isRule34Video ? (\n                                        <iframe\n                                            className=\"media-container\"\n                                            src={embedUrl}\n                                            frameBorder=\"0\"\n                                            allowFullScreen\n                                            loop\n                                            title=\"Embedded Video\"\n                                            onLoad={() => handleMediaLoad(index)}\n                                        ></iframe>\n                                    ) : isVideo ? (\n                                        <video\n                                            ref={el => mediaRefs.current[index] = el}\n                                            src={firstVideoLink}\n                                            controls\n                                            muted={fullscreenMedia !== index}\n                                            volume={globalVolume}\n                                            loop\n                                            \n                                            onClick={fullscreenMedia === index ? (e) => {\n                                            e.stopPropagation();\n                                            e.preventDefault();\n                                            \n                                            const video = mediaRefs.current[index];\n                                            if (video && video.tagName === 'VIDEO') {\n                                                if (video.paused) {\n                                                    video.play().catch(err => console.log('Play prevented:', err));\n                                                } else {\n                                                    video.pause();\n                                                }\n                                            }\n                                        } : undefined}\n                                            onLoadedData={() => {\n                                                handleMediaLoad(index);\n                                                // Apply global volume on load\n                                                if (mediaRefs.current[index]) {\n                                                    mediaRefs.current[index].volume = globalVolume;\n                                                }\n                                            }}\n                                            onError={(e) => handleVideoError(e, firstVideoLink)}\n                                            onLoadStart={() => {\n                                                setCookies();\n                                            }}\n                                        />\n                                    ) : (\n                                        <img\n                                            ref={el => mediaRefs.current[index] = el}\n                                            src={firstVideoLink}\n                                            alt=\"Media\"\n                                            onLoad={() => handleMediaLoad(index)}\n                                            onError={(e) => handleImageError(e, firstVideoLink, index)}\n                                        />\n                                    )}\n                                    {fullscreenMedia === index && videoLinks && Array.isArray(videoLinks) && videoLinks.slice(1).map((link, i) => (\n                                        <div key={i} className=\"fullscreen-media-container\">\n                                            <img className='fullscreen-media'\n                                                ref={el => mediaRefs.current[`${index}_${i}`] = el}\n                                                src={link}\n                                                alt=\"Media\"\n                                                onError={(e) => handleImageError(e, link, index)}\n                                                onLoad={() => {\n                                                    setCookies();\n                                                }}\n                                            />\n                                        </div>\n                                    ))}\n                                </div>\n                                <div className=\"icon-container\">\n                                    <button\n                                        className=\"close-icon\"\n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            handleMediaClose();\n                                        }}\n                                        aria-label=\"Close media\"\n                                    >\n                                        <i className=\"fas fa-times\"></i>\n                                    </button>\n                                    <button\n                                        className=\"postlink-icon\"\n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            handleIconClick(postLink);\n                                        }}\n                                        aria-label=\"Open post link\"\n                                    >\n                                        <i className=\"fas fa-link\"></i>\n                                    </button>\n                                    {(!postLink.includes('kusowanka') && !postLink.includes('donmai')  && !postLink.includes('e621')) && (\n                                        <button\n                                            className=\"similar-icon\"\n                                            onClick={(e) => {\n                                                e.stopPropagation();\n                                                handleSimilar(postLink);\n                                            }}\n                                            aria-label=\"Find similar media\"\n                                        >\n                                            <i className=\"fas fa-clone\"></i>\n                                        </button>\n                                    )}\n                                </div>\n                                <button\n                                    className=\"remove-icon\"\n                                    onClick={(e) => {\n                                        e.stopPropagation();\n                                        handleRemove(postLink);\n                                    }}\n                                    aria-label=\"Remove media\"\n                                >\n                                        <i className=\"fas fa-trash\"></i>\n                                </button>\n                            </div>\n                        );\n                    })}\n                    {loading && (\n                        <div className=\"loading-placeholder\"></div>\n                    )}\n                </Masonry>\n                <div id=\"bottom-of-page\"></div>\n                <div className=\"overlay-buttons\">\n                    <button\n                        onClick={handleSettingsOpen}\n                        className=\"settings-button\"\n                        aria-label=\"Settings\"\n                    >\n                        <i className=\"fas fa-cog\"></i>\n                        </button>\n                    <button\n                        onClick={() => {\n                            const newAutoScroll = !autoScroll;\n                            setAutoScroll(newAutoScroll);\n                            saveAutoScrollPreference(newAutoScroll);\n                        }}\n                        className={`auto-scroll-button ${autoScroll ? 'active' : ''}`}\n                        aria-label=\"Toggle auto scroll\"\n                    >\n                        <i className=\"fas fa-arrow-down\"></i>\n                    </button>\n                </div>\n                {showSettings && (\n                    <div className=\"settings-dialog\">\n                        <div className=\"settings-content\">\n                            <div className=\"settings-header\">\n                                <h2>Gallery Settings</h2>\n                                <button onClick={() => setShowSettings(false)}>\n                                    <i className=\"fas fa-times\"></i>\n                                </button>\n                            </div>\n                            <div className=\"settings-body\">\n                                {/* 1. Tag Blacklist */}\n                                <div className=\"settings-item\">\n                                    <label htmlFor=\"tag-blacklist\">\n                                        <i className=\"fas fa-ban\"></i>\n                                        Tag Blacklist (comma-separated)\n                                    </label>\n                                    <div className=\"blacklist-controls\">\n                                        <input\n                                            type=\"text\"\n                                            id=\"tag-blacklist\"\n                                            value={tagBlacklist}\n                                            onChange={handleTagBlacklistChange}\n                                            placeholder=\"Enter tags to blacklist\"\n                                        />\n                                        <button \n                                            className=\"delete-blacklisted-button\"\n                                            onClick={handleDeleteBlacklisted}\n                                            title=\"Delete all media containing blacklisted tags\"\n                                        >\n                                            <i className=\"fas fa-trash-alt\"></i>\n                                            Delete All\n                                        </button>\n                                    </div>\n                                </div>\n\n                                {/* 3. Include Demo Content */}\n                                <div className=\"settings-item\">\n                                    <label>\n                                        <i className=\"fas fa-eye\"></i>\n                                        Include Demo Content\n                                    </label>\n                                    <div className=\"default-links-toggle settings-toggle\">\n                                        <button \n                                            className={`content-filter-option ${showDefaultLinks ? 'active' : ''}`}\n                                            onClick={() => {\n                                                const newValue = true;\n                                                setShowDefaultLinks(newValue);\n                                                saveShowDefaultLinksPreference(newValue);\n                                                setCurrentPage(1);\n                                                setMediaUrls([]);\n                                                fetchMedia(1, initialMediaPerPage);\n                                            }}\n                                        >\n                                            Show\n                                        </button>\n                                        <button \n                                            className={`content-filter-option ${!showDefaultLinks ? 'active' : ''}`}\n                                            onClick={() => {\n                                                const newValue = false;\n                                                setShowDefaultLinks(newValue);\n                                                saveShowDefaultLinksPreference(newValue);\n                                                setCurrentPage(1);\n                                                setMediaUrls([]);\n                                                fetchMedia(1, initialMediaPerPage);\n                                            }}\n                                        >\n                                            Hide\n                                        </button>\n                                    </div>\n                                </div>\n\n                                {/* 4. Sort by */}\n                                <div className=\"settings-item\">\n                                    <label htmlFor=\"filter\">\n                                        <i className=\"fas fa-sort\"></i>\n                                        Sort by\n                                    </label>\n                                    <select \n                                        id=\"filter\" \n                                        value={filter} \n                                        onChange={(e) => {\n                                            handleFilterChange(e.target.value);\n                                        }}\n                                    >\n                                        <option value=\"Default\">Default</option>\n                                        <option value=\"Newest\">Newest</option>\n                                        <option value=\"Random\">Random</option>\n                                        <option value=\"Oldest\">Oldest</option>\n                                    </select>\n                                </div>\n\n                                {/* 5. Auto-Scroll Speed */}\n                                <div className=\"settings-item\">\n                                    <label htmlFor=\"scroll-speed\">\n                                        <i className=\"fas fa-arrow-down\"></i>\n                                        Auto-Scroll Speed: {scrollSpeed}px/tick\n                                    </label>\n                                    <input\n                                        id=\"scroll-speed\"\n                                        type=\"range\"\n                                        min=\"0.2\"\n                                        max=\"2\"\n                                        step=\"0.2\"\n                                        value={scrollSpeed}\n                                        onChange={(e) => {\n                                            const newSpeed = parseFloat(e.target.value);\n                                            setScrollSpeed(newSpeed);\n                                            saveScrollSpeedPreference(newSpeed);\n                                        }}\n                                        className=\"scroll-speed-slider\"\n                                    />\n                                    <div className=\"speed-range-labels\">\n                                        <span>Very Slow</span>\n                                        <span>Fast</span>\n                                    </div>\n                                </div>\n\n                                {/* 6. Volume */}\n                                <div className=\"settings-item\">\n                                    <label htmlFor=\"volume-control\">\n                                        <i className=\"fas fa-volume-up\"></i>\n                                        Volume: {Math.round(globalVolume * 100)}%\n                                    </label>\n                                    <input\n                                        id=\"volume-control\"\n                                        type=\"range\"\n                                        min=\"0\"\n                                        max=\"1\"\n                                        step=\"0.01\"\n                                        value={globalVolume}\n                                        onChange={(e) => {\n                                            const newVolume = parseFloat(e.target.value);\n                                            setGlobalVolume(newVolume);\n                                            saveVolumePreference(newVolume);\n                                        }}\n                                        className=\"volume-slider\"\n                                    />\n                                    <div className=\"volume-range-labels\">\n                                        <span>0%</span>\n                                        <span>100%</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n                {showConfirmClear && (\n                    <div className=\"confirm-dialog\">\n                        <div className=\"confirm-content\">\n                            <div className=\"confirm-header\">\n                                <h2>Confirm Clear Collection</h2>\n                            </div>\n                            <div className=\"confirm-body\">\n                                <p>Are you sure you want to clear your <strong>{collections.find(c => c.id === activeCollection)?.name}</strong> collection?</p>\n                                <p>This action cannot be undone and will remove all saved media.</p>\n                            </div>\n                            <div className=\"confirm-options\">\n                                <button onClick={cancelClearCollection}>\n                                    Cancel\n                                </button>\n                                <button onClick={confirmClearCollection}>\n                                    Yes, Clear Collection\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default React.memo(VideoList);"],"names":["isDevelopment","window","location","hostname","config","API_URL","console","log","LOCAL_STORAGE_KEY","saveToLocalStorage","mediaLinks","storageKey","arguments","length","undefined","localStorage","setItem","JSON","stringify","error","getFromLocalStorage","data","getItem","parse","VideoList","_collections$find","mediaUrls","setMediaUrls","useState","currentPage","setCurrentPage","fullscreenMedia","setFullscreenMedia","loading","setLoading","autoScroll","setAutoScroll","filter","setFilter","showSettings","setShowSettings","notifications","setNotifications","isClickable","setIsClickable","loadedMedia","setLoadedMedia","randomSeed","setRandomSeed","Date","now","tagFilter","setTagFilter","contentFilter","setContentFilter","globalVolume","setGlobalVolume","socket","setSocket","searchQuery","setSearchQuery","guestId","useRef","Math","random","toString","substr","showDefaultLinks","setShowDefaultLinks","activeCollection","setActiveCollection","collections","id","name","showMobileMenu","setShowMobileMenu","isMobile","setIsMobile","prevScrollY","scrollAnimation","mediaRefs","mediaSet","Set","observer","scrapeNotificationId","similarNotificationId","tagSearchNotificationId","showConfirmClear","setShowConfirmClear","tagBlacklist","setTagBlacklist","scrollSpeed","setScrollSpeed","tagSearchQuery","setTagSearchQuery","konamiSequence","setKonamiSequence","konamiCode","useMemo","shuffleArray","useCallback","array","newArray","reverse","rand","seedrandom","i","j","floor","fetchConfig","credentials","filterMediaByTag","searchTerm","lowercaseSearchTerm","toLowerCase","item","tags","Array","isArray","some","tag","includes","Object","values","categoryTags","applyTagBlacklist","media","blacklist","split","map","trim","allTags","forEach","push","blacklistedTag","fetchMedia","async","page","limit","currentCollection","find","c","localStorageLinks","postLink","videoLinks","defaultLinks","defaultMediaLinks","totalAvailableItems","startIndex","sortedMediaLinks","endIndex","min","pageMediaUrls","slice","current","clear","uniqueMediaUrls","has","add","prevMediaUrls","isUserContent","isDefault","userItems","_item$","defaultItems","_item$2","setCookies","cookies","cookie","document","value","domain","path","showNotification","message","type","newNotification","prev","setTimeout","notification","removeNotification","handleTagSearch","query","notificationId","progress","isComplete","existingNotificationIndex","findIndex","n","updatedNotifications","contentFilterValue","headers","fetch","method","body","contentType","ok","Error","showProgressNotification","scrollToMedia","index","mediaElement","scrollIntoView","behavior","block","handleMediaClick","tagName","pause","muted","selectedVideo","volume","play","catch","err","then","secondErr","mediaContainer","getElementById","classList","querySelectorAll","button","style","zIndex","handleMediaClose","rect","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","remove","handleClickOutside","event","_mediaRefs$current$fu","contains","target","closest","handleKeyPress","e","key","nextIndex","currentMedia","nextMedia","prevIndex","prevMedia","debouncedPageIncrement","timeoutId","prevPage","clearTimeout","lastMediaElementRef","node","disconnect","IntersectionObserver","entries","entry","isIntersecting","threshold","rootMargin","observe","useEffect","handleResize","isMobileView","addEventListener","removeEventListener","handleKonamiKeyPress","newSequence","code","every","newFilter","saveContentFilterPreference","toUpperCase","overflow","videoDuration","duration","scrollBehavior","scrollDistance","max","smoothScroll","currentScroll","pageYOffset","scrollHeight","scrollTo","requestAnimationFrame","cancelAnimationFrame","script","createElement","src","appendChild","removeChild","seed","selectedMedia","handleScroll","currentScrollY","scrollY","scrollTimeout","onScroll","breakpointColumnsObj","default","handleImageError","link","display","mediaLink","from","el","saveShowDefaultLinksPreference","show","getShowDefaultLinksFromCookie","match","getContentFilterFromCookie","saveTagBlacklistPreference","encodeURIComponent","getTagBlacklistFromCookie","decodeURIComponent","handleFilterChange","filterValue","loadPreferences","getScrollSpeedFromCookie","parseFloat","getAutoScrollFromCookie","getFilterFromCookie","savedTagBlacklist","savedShowDefaultLinks","savedContentFilter","savedActiveCollection","getActiveCollectionFromCookie","ref","handleExport","localData","dataStr","dataBlob","Blob","url","URL","createObjectURL","a","href","download","click","revokeObjectURL","handleImport","file","files","reader","FileReader","onload","content","result","_ref","validContent","readAsText","handleMediaLoad","handleTagClick","stopPropagation","TagsPanel","_ref2","_jsx","className","children","categorizedTags","general","_jsxs","label","category","idx","onClick","handleAddTagToFilter","combinedFilter","title","addTagToBlacklist","currentBlacklist","t","newBlacklist","join","newSocket","setupSocket","io","withCredentials","transports","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","timeout","on","emit","isGuest","handleProgressEvent","notificationIdRef","prevNotifications","_data$newItems","currentNotification","totalLinksAdded","linksAdded","newLinksCount","newItems","updatedLinksAdded","count","typeLabel","word","charAt","linkCountMessage","currentId","formattedItems","mediaItem","currentLinks","addToLocalStorage","handleClearCollection","handleUnifiedSearch","startsWith","alert","scrapeSavedLinks","urlToScrape","handleScrape","videoObservers","handleVideoVisibilityChange","video","setupVideoObservers","_ref3","parseInt","root","timer","handleCollectionSwitch","collectionId","collection","reload","cursor","background","color","border","padding","borderRadius","fontSize","fontWeight","marginLeft","animation","_Fragment","onChange","onKeyPress","placeholder","marginRight","accept","width","Masonry","breakpointCols","columnClassName","firstVideoLink","isVideo","endsWith","isRule34Video","embedUrl","replace","isLoaded","frameBorder","allowFullScreen","loop","onLoad","controls","preventDefault","paused","onLoadedData","onError","keys","Number","handleVideoError","onLoadStart","alt","open","response","errorData","json","handleSimilar","handleRemove","handleSettingsOpen","newAutoScroll","saveAutoScrollPreference","htmlFor","handleDeleteBlacklisted","filteredMedia","newValue","step","newSpeed","speed","round","newVolume","cancelClearCollection","confirmClearCollection","removeItem","React"],"sourceRoot":""}